{"version":3,"sources":["../src/AnimatorDelay.ts","../src/AnimationElement.ts","../src/ScrollAnimator.ts","index.ts"],"names":["AnimatorDelay","animateDelay","delayComplete","start","timerRunning","update","deltaTime","timeElapsed","callbackFired","reset","AnimationElement","_htmlElement","animateOnce","dataset","_animateOnce","animateClass","_animateClass","animateThreshold","_animateThreshold","parseFloat","animateRootMargin","_animateRootMargin","animateDelaySeconds","_animateDelaySeconds","animatorDelay","onAnimationCanPlay","bind","observer","IntersectionObserver","onIntersectionCallback","rootMargin","threshold","observe","entries","animationHasPlayedOnce","disconnect","i","length","entry","isIntersecting","animationIsPlaying","intersectionRatio","play","finish","onTransitionComplete","removeEventListener","classList","add","addEventListener","remove","dispose","ScrollAnimator","create","elements","requestAnimationFrameRunning","window","requestAnimationFrame","htmlElement","animationElements","push","now","then"],"mappings":"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","file":"example.a56ed389.js","sourceRoot":"..\\example","sourcesContent":["export class AnimatorDelay \r\n{\r\n    private timerRunning: boolean = false;\r\n    private timeElapsed: number = 0;\r\n    private callbackFired: boolean = false;\r\n\r\n    constructor(private animateDelay: number, private delayComplete: Function)\r\n    {\r\n    }\r\n\r\n    public start(): void\r\n    {\r\n        this.timerRunning = true;\r\n    }\r\n\r\n    public update(deltaTime: number): void\r\n    {\r\n        if (this.timerRunning === false)\r\n            return;\r\n\r\n        this.timeElapsed += deltaTime;\r\n\r\n        if (this.timeElapsed > this.animateDelay)\r\n        {\r\n            this.delayComplete();\r\n            this.callbackFired = true;\r\n            this.reset();\r\n        }\r\n    }\r\n\r\n    private reset(): void\r\n    {\r\n        this.timerRunning = false;\r\n        this.timeElapsed = 0;\r\n    }\r\n\r\n    public get animatorDelayComplete(): boolean \r\n    {\r\n        return this.callbackFired;\r\n    }\r\n}","import { AnimatorDelay } from \"./AnimatorDelay\";\r\nimport { AnimatorElement } from \"./AnimatorElement\";\r\n\r\nexport class AnimationElement implements AnimatorElement\r\n{\r\n    private observer: IntersectionObserver;\r\n\r\n    private _animateOnce: boolean = false;\r\n    private _animateClass: string = \"animate-in\";\r\n    private _animateThreshold: number = 0.5;\r\n    private _animateRootMargin: string = \"0px\";\r\n    private _animateDelaySeconds: number = 0;\r\n\r\n    private animatorDelay: AnimatorDelay;\r\n    private animationHasPlayedOnce: boolean = false;\r\n    private animationIsPlaying: boolean = false;\r\n\r\n    constructor(private _htmlElement: HTMLElement)\r\n    {\r\n        const animateOnce: string | undefined = this._htmlElement.dataset.animateOnce;\r\n        if (animateOnce)\r\n        {\r\n            this._animateOnce = animateOnce === \"true\";\r\n        }\r\n\r\n        const animateClass: string | undefined = this._htmlElement.dataset.animateClass;\r\n        if (animateClass)\r\n        {\r\n            this._animateClass = animateClass;\r\n        }\r\n\r\n        const animateThreshold: string | undefined = this._htmlElement.dataset.animateThreshold;\r\n        if (animateThreshold)\r\n        {\r\n            this._animateThreshold = parseFloat(animateThreshold);\r\n        }\r\n\r\n        const animateRootMargin: string | undefined = this._htmlElement.dataset.animateRootMargin;\r\n        if (animateRootMargin)\r\n        {\r\n            this._animateRootMargin = animateRootMargin;\r\n        }\r\n\r\n        const animateDelaySeconds: string | undefined = this._htmlElement.dataset.animateDelaySeconds;\r\n        if (animateDelaySeconds)\r\n        {\r\n            this._animateDelaySeconds = parseFloat(animateDelaySeconds);\r\n        }\r\n\r\n        this.animatorDelay = new AnimatorDelay(this._animateDelaySeconds, this.onAnimationCanPlay.bind(this));\r\n\r\n        this.observer = new IntersectionObserver(this.onIntersectionCallback.bind(this), {\r\n            rootMargin: this._animateRootMargin,\r\n            threshold: this._animateThreshold\r\n        });\r\n\r\n        this.observer.observe(this._htmlElement);\r\n    }\r\n\r\n    private onIntersectionCallback(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void\r\n    {\r\n        if (this.animationHasPlayedOnce === true && this._animateOnce === true)\r\n        {\r\n            // Configured to play the animation once, no need to keep the observer\r\n            return observer.disconnect();\r\n        }\r\n\r\n        for (let i = 0; i < entries.length; i++)\r\n        {\r\n            const entry: IntersectionObserverEntry = entries[i];\r\n            if (entry.isIntersecting === true && this.animationIsPlaying === false && entry.intersectionRatio > 0)\r\n            {\r\n                this.play();\r\n            }\r\n            else if (this.animationIsPlaying === false)\r\n            {\r\n                this.finish();\r\n            }\r\n        }\r\n    }\r\n\r\n    private play(): void\r\n    {\r\n        this.animatorDelay.start();\r\n    }\r\n\r\n    private onTransitionComplete()\r\n    {\r\n        this.animationIsPlaying = false;\r\n        this._htmlElement.removeEventListener(\"animationcancel\", this.onTransitionComplete.bind(this));\r\n        this._htmlElement.removeEventListener(\"animationend\", this.onTransitionComplete.bind(this));\r\n        this._htmlElement.removeEventListener(\"transitioncancel\", this.onTransitionComplete.bind(this));\r\n        this._htmlElement.removeEventListener(\"transitionend\", this.onTransitionComplete.bind(this));\r\n    }\r\n\r\n    private onAnimationCanPlay(): void\r\n    {\r\n        this.animationIsPlaying = true;\r\n        this.animationHasPlayedOnce = true;\r\n\r\n        this._htmlElement.classList.add(this._animateClass);\r\n        this._htmlElement.addEventListener(\"animationcancel\", this.onTransitionComplete.bind(this), false);\r\n        this._htmlElement.addEventListener(\"animationend\", this.onTransitionComplete.bind(this), false);\r\n        this._htmlElement.addEventListener(\"transitioncancel\", this.onTransitionComplete.bind(this), false);\r\n        this._htmlElement.addEventListener(\"transitionend\", this.onTransitionComplete.bind(this), false);\r\n    }\r\n\r\n    private finish(): void\r\n    {\r\n        this._htmlElement.classList.remove(this._animateClass);\r\n    }\r\n\r\n    public dispose(): void\r\n    {\r\n        this.observer.disconnect();\r\n    }\r\n\r\n    public update(deltaTime: number): void\r\n    {\r\n        this.animatorDelay.update(deltaTime);\r\n    }\r\n}","import { AnimationElement } from \"./AnimationElement\";\n\nexport class ScrollAnimator \n{\n    private animationElements: Array<AnimationElement> = [];\n    private requestAnimationFrameRunning: boolean = false;\n\n    constructor()\n    {\n    }\n\n    /**\n     * Create observers from a NodeListOf<HTMLElement>\n     * Clears existing list of elements if any exist\n     * @param elements\n     */\n    public create(elements: NodeListOf<HTMLElement>): void\n    {\n        this.dispose();\n\n        if (this.requestAnimationFrameRunning === false)\n        {\n            this.requestAnimationFrameRunning = true;\n            window.requestAnimationFrame(this.update.bind(this));\n        }\n\n        for (let i = 0; i < elements.length; i++)\n        {\n            const htmlElement = elements[i] as HTMLElement;\n\n            this.animationElements.push(new AnimationElement(htmlElement));\n        }\n    }\n\n    /**\n     * Dispose of all observers and remove existing list elements\n     */\n    public dispose(): void\n    {\n        for (let i = 0; i < this.animationElements.length; i++)\n        {\n            this.animationElements[i].dispose();\n        }\n        this.animationElements = [];\n    }\n\n    private then: number = 0;\n    private update(now: number): void\n    {\n        if (this.requestAnimationFrameRunning === false)\n        {\n            return;\n        }\n\n        now *= 0.001;\n        const deltaTime: number = (now - this.then);\n\n        for (let i = 0; i < this.animationElements.length; i++)\n        {\n            this.animationElements[i].update(deltaTime);\n        }\n\n        this.then = now;\n        requestAnimationFrame(this.update.bind(this));\n    }\n}","// import { ScrollAnimator } from \"simple-scroll-animate\"; \nimport { ScrollAnimator } from \"../\";\n\nwindow.addEventListener(\"load\", () =>\n{\n    const scrollAnimator = new ScrollAnimator();\n    scrollAnimator.create(document.querySelectorAll(\".js-animate\"));\n\n    const terminate = document.querySelector(\".js-dispose-all\");\n    terminate?.addEventListener(\"click\", function ()\n    {\n        scrollAnimator.dispose();\n    }, false);\n\n}, false);"]}